# Wordpress Starter Theme

Modern WordPress starter theme with Vite, Tailwind CSS v4, and quality tooling.

## Features

- **Modern Build System**: Vite for fast, efficient builds with manifest-based asset loading
- **Tailwind CSS v4**: Latest version using the official Vite plugin (no PostCSS required)
- **TypeScript Support**: Full TypeScript integration for blocks and frontend code
- **Gutenberg Blocks**: Example static and dynamic blocks with proper registration
- **Quality Tooling**: PHPCS (WordPress Coding Standards), ESLint, Prettier
- **PHP 8.3**: Target modern PHP with type safety

## Requirements

- PHP >= 8.3
- Node.js >= 18
- pnpm (package manager)
- Composer

## Installation

1. **Install PHP dependencies:**
```bash
composer install
```

2. **Install Node dependencies:**
```bash
pnpm install
```

3. **Build assets:**
```bash
pnpm build
```

## Development

### Watch Mode

Start development with watch mode (no dev server, outputs to `/assets`):

```bash
pnpm dev
```

This watches your source files and rebuilds on changes.

### Production Build

Create optimized production assets:

```bash
pnpm build
```

## Code Quality

### PHP Linting

**Run PHPCS (WordPress Coding Standards):**
```bash
composer phpcs
```

**Auto-fix PHPCS issues:**
```bash
composer phpcbf
```

**PHP Syntax Check:**
```bash
composer lint:php
```

### JavaScript/TypeScript Linting

**Standard lint (warns at 400 lines):**
```bash
pnpm lint:js
```

**Strict lint for CI (errors at 500 lines):**
```bash
pnpm lint:js:strict
```

### Code Formatting

**Format all source files with Prettier (tabs):**
```bash
pnpm format
```

## Directory Structure

```
startuptheme/
├── assets/                 # Built files (generated by Vite)
│   ├── .vite/
│   │   └── manifest.json  # Asset manifest for WordPress
│   ├── *.css              # Compiled stylesheets
│   └── *.js               # Compiled scripts
├── blocks/                # Gutenberg blocks
│   ├── example-static/    # Static block example
│   │   ├── block.json
│   │   ├── editor.tsx
│   │   └── view.tsx
│   └── example-dynamic/   # Dynamic block example
│       ├── block.json
│       ├── editor.tsx
│       └── render.php
├── inc/                   # Theme includes
│   ├── theme-setup.php    # Theme support and configuration
│   ├── enqueue-assets.php # Asset loading via manifest
│   └── block-registration.php # Block registration
├── src/                   # Source files
│   ├── main.ts           # Main frontend script
│   ├── main.css          # Main stylesheet (with Tailwind)
│   └── editor.css        # Block editor styles
├── template-parts/        # Template partials
├── composer.json         # PHP dependencies
├── package.json          # Node dependencies
├── tsconfig.json         # TypeScript configuration
├── vite.config.ts        # Vite configuration
├── .eslintrc.cjs         # ESLint configuration
├── .prettierrc.json      # Prettier configuration
└── .phpcs.xml.dist       # PHPCS configuration
```

## Creating New Blocks

### 1. Create Block Directory

```bash
mkdir -p blocks/my-block
```

### 2. Create block.json

```json
{
	"$schema": "https://schemas.wp.org/trunk/block.json",
	"apiVersion": 3,
	"name": "cwp/my-block",
	"version": "1.0.0",
	"title": "My Block",
	"category": "text",
	"icon": "smiley",
	"description": "My custom block",
	"textdomain": "cwp",
	"editorScript": "file:./editor.js",
	"attributes": {
		"content": {
			"type": "string",
			"default": ""
		}
	}
}
```

### 3. Create editor.tsx

```typescript
import { registerBlockType } from '@wordpress/blocks';
import { useBlockProps } from '@wordpress/block-editor';

registerBlockType('cwp/my-block', {
	edit: ({ attributes, setAttributes }) => {
		const blockProps = useBlockProps();
		return <div {...blockProps}>Edit view</div>;
	},
	save: ({ attributes }) => {
		const blockProps = useBlockProps.save();
		return <div {...blockProps}>Save view</div>;
	},
});
```

### 4. Update vite.config.ts

Add your block to the `rollupOptions.input`:

```typescript
'my-block-editor': resolve(__dirname, 'blocks/my-block/editor.tsx'),
```

### 5. Register in block-registration.php

Add your block name to the `$blocks` array:

```php
$blocks = array(
	'example-static',
	'example-dynamic',
	'my-block', // Add this
);
```

### 6. Build and Test

```bash
pnpm build
```

Activate the theme and check the block appears in the editor.

## Text Domain

All theme and block translations use the `cwp` text domain:
- PHP: `__( 'Text', 'cwp' )`
- JS: `__( 'Text', 'cwp' )`
- block.json: `"textdomain": "cwp"`

## Deployment

1. Run production build:
```bash
pnpm build
```

2. Verify quality checks pass:
```bash
composer phpcs
pnpm lint:js:strict
```

3. Deploy files:
   - Include: theme files, `/assets`, `/vendor`, `/node_modules` (or rebuild on server)
   - Exclude: `/src`, build configs, `.git`

## Asset Loading

The theme uses Vite's manifest for asset loading in all environments (no dev server). WordPress reads the manifest at `/assets/.vite/manifest.json` to resolve hashed asset paths.

**Manifest-based enqueuing** ensures cache-busting and proper asset resolution.

## Coding Standards

- **PHP**: WordPress Coding Standards (WPCS) via PHPCS
- **JavaScript/TypeScript**: @wordpress/eslint-plugin, max-lines warnings/errors
- **Formatting**: Prettier with tabs (tabWidth: 4)

## License

GPL-2.0-or-later

## Support

For issues and questions, refer to project documentation or WordPress support resources.
